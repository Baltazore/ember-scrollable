<div class="form">
  {{#as-form model=model action="send" as |form|}}
    <a {{action "toggleIsEditingHeader"}}>Edit</a>
    {{#liquid-if isEditingHeader}}
      {{#as-form/fieldset}}
        {{as-form/select
          form=form
          prompt="Choose a template..."
          label="Template"
          content=templates
          value=selectedTemplate
          optionValuePath="content"}}

        {{as-form/input form=form name="recipients" label="To"}}
        {{as-form/input form=form name="from" label="From"}}
        {{as-form/input form=form name="cc" label="CC"}}
        {{as-form/input form=form name="bcc" label="BCC"}}
      {{/as-form/fieldset}}
    {{else}}
      <dl class="header">
        <dt>Template</dt>
        <dd>{{selectedTemplate.name}}</dd>

        <dt>To</dt>
        <dd>{{model.recipients}}</dd>

        <dt>From</dt>
        <dd>{{model.from}}</dd>

        <dt>CC</dt>
        <dd>{{model.cc}}</dd>

        <dt>BCC</dt>
        <dd>{{model.bcc}}</dd>
      </dl>
    {{/liquid-if}}

    {{#as-form/fieldset}}
      {{#liquid-if showPreview}}
        <p>
          {{preview}}
        </p>
      {{else}}
        {{as-form/input
          form=form
          name="subject"
          errorProperty="subject"
          label="Subject"}}

        {{as-form/textarea
          form=form
          name="body"
          errorProperty="body"
          label="Body"}}
      {{/liquid-if}}

      {{#as-action-group}}
        {{#as-form/submit form=form}}Send{{/as-form/submit}}
        {{#as-action action="togglePreview"}}Preview{{/as-action}}
      {{/as-action-group}}
    {{/as-form/fieldset}}
  {{/as-form}}
</div>
