{{#as-side-panel class="interaction" close="hideSidePanel" previous="previous" next="next"}}
  <div>
    <header>
      <div class="date">
        <span class="month">{{moment model.scheduledCallTime "MMMM"}}</span>
        <span class="day">{{moment model.scheduledCallTime "D"}}</span>
      </div>

      <div class="content">
        <span class="primary-contact">
          {{as-avatar person=model.primaryContact}}
        </span>

        <h1>
          <span>{{model.advisor.name}}</span>

          <small>
            <a target="_blank" href={{model.project.pistachioUrl}}>
              {{model.project.name}}
            </a>
          </small>
        </h1>

        <span class="call-times">
          <span class="local-time">
            {{moment model.scheduledCallTime "h:mm A"}}
          </span>

          {{#each profile in profiles}}
            {{#if profile.person.timeZone}}
              <span class={{profile.class}}>
                <span class="highlight">{{local-moment model.scheduledCallTime profile.person.timeZone "z"}}</span>
                <span>{{local-moment model.scheduledCallTime profile.person.timeZone "h:mm A"}}</span>
              </span>
            {{/if}}
          {{/each}}
        </span>

        {{#if model.speak}}
          <ul class="speak-details">
            <li>
              <span class="speak-title">Speak No.</span>
              <span class="speak-detail">{{model.speakPhoneNumber}}</span>
            </li>

            <li>
              <span class="speak-title">Code</span>
              <span class="speak-detail">{{model.speakCode}}</span>
            </li>
          </ul>
        {{/if}}

        <a target="_blank" href={{model.pistachioUrl}}>View interaction page</a>
      </div>
    </header>

    <section class="profiles">
      <ul>
        {{#each profile in profiles}}
          <li>
            {{#as-profile
              person=profile.person
              title=profile.title
              class=profile.class}}
              {{#if profile.person.timeZone}}
                <div class="call-time">
                  {{#tool-tipster title=(local-moment model.scheduledCallTime profile.person.timeZone "h:mm A z")}}
                    <i></i>
                    <span>{{local-moment model.scheduledCallTime profile.person.timeZone "z"}}</span>
                  {{/tool-tipster}}
                </div>
              {{/if}}
            {{/as-profile}}
          </li>
        {{/each}}
      </ul>
    </section>

    <section class="checklist-items">
      <header>
        {{as-checklist-status items=checklistItems}}

        <a target="_blank" href={{model.checklistUrl}}>Show checklist</a>
      </header>

      <ul>
        {{#each checklistItem in checklistItems}}
          <li class={{if checklistItem.completed 'completed'}}>{{checklistItem.title}}</li>
        {{/each}}
      </ul>
    </section>
  </div>

  <section class="actions">
    <div class="action {{if showForm 'active'}}">
      <button class="success" {{action "toggleForm"}}>Complete Interaction</button>

      <div class="content">
        <section class="form">
          {{#as-form model=completion}}
            {{#as-form/fieldset}}
              {{as-form/input
                name="duration"
                errorProperty="duration"
                label="Call Duration (minutes)"}}

              {{as-form/select
                name="quality"
                label="Call Quality"
                content=qualityOptions}}
            {{/as-form/fieldset}}

            {{as-form/submission
              label="Charge Client"
              submit="chargeClient"
              requestPromise=requestPromise}}
          {{/as-form}}
        </section>
      </div>
    </div>

    <div class="action reschedule">
      {{#link-to "dashboard.schedule-interaction" model.id tagName="button"}}
        Reschedule Interaction
      {{/link-to}}
    </div>
  </section>
{{/as-side-panel}}
