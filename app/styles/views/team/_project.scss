$project-angles-text-color: $body-font-color;
$project-angle-background-color: $snow;
$project-angle-border-color: darken($project-angle-background-color, 5%);
$project-angle-border: 1px solid $project-angle-border-color;
$project-angle-heading-color: $charcoal;
$project-angle-section-padding: $column-gutter;

$angle-member-width: $super-number-height;
$angle-member-border: 1px solid $smoke;
$angle-member-radius: $global-radius;
$angle-member-inner-padding: 3px;

$angle-add-member-button-size: $super-number-height * .6;
$angle-add-member-button-color: scale-color($primary-color, $lightness: -$alert-function-factor);
$angle-add-member-avatar-size: $avatar-size-tiny;
$angle-add-member-dropdown-padding: $angle-member-inner-padding * 2;
$angle-add-member-search-icon-padding: $form-spacing / 2;
$angle-add-member-search-icon-height: $form-label-line-height;
$angle-add-member-search-icon-color: $angle-add-member-button-color;

@mixin angle-avatar-input-grid-size {
  @extend %grid-column-large-3;
  @extend %grid-column-medium-4;
  @extend %grid-column-small-6;
}

.angles {
  @extend %angles-section;

  .priority {
    display: inline-block;
    margin-left: $column-gutter / 2;

    button {
      border: 0;
      display: block;
      height: 12px;
      margin: 4px 0;
      width: 12px;
    }

    &.high > button {
      @include project-priority($alert-color);
    }

    &.medium > button {
      @include project-priority($warning-color);
    }

    &.low > button {
      @include project-priority($info-color);
    }

  }

  .input-avatar {
    @extend %input-avatar;

    .delete {
      @include button-icon(close);
      @include single-transition(background-color, 100ms, linear);

      border: $angle-member-border;
      border-radius: $global-rounded;
      display: none;
      position: absolute;
      right: 0;
      top: -$super-number-arrow-size / 2;
      z-index: 1;

      &:before {
        line-height: $super-number-arrow-size;
        width: $super-number-arrow-size;
      }

      &:hover {
        background-color: $charcoal;
        color: $white;
      }
    }

    &:hover .delete {
      display: block;
    }
  }
}

.angle-avatar-add {
  @include angle-avatar-input-grid-size;

  line-height: $angle-member-width;

  button {
    @extend %angle-avatar-add-button;
  }

  &.dropdown {
    ul {
      max-width: none;
      width: auto;

      li {
        line-height: $angle-add-member-avatar-size;
        white-space: nowrap;

        a {
          padding: $angle-add-member-dropdown-padding $column-gutter / 2;
        }
      }
    }

    img {
      @include detached-border($color: $global-section-border-color);

      display: inline-block;
      height: $angle-add-member-avatar-size;
      margin-right: $column-gutter / 4;
      width: $angle-add-member-avatar-size;
    }

    .search {
      padding: $angle-member-inner-padding;

      i {
        @include icon(search);

        color: $angle-add-member-search-icon-color;
        line-height: $angle-add-member-search-icon-height;
        padding: $angle-add-member-search-icon-padding $column-gutter / 2;
        position: absolute;
      }

      input {
        border-radius: $global-radius / 2;
        margin-bottom: 0;
        padding-left: $angle-add-member-avatar-size * 1.5;
      }
    }
  }
}

%angles-section {
  header {
    padding: $project-angle-section-padding;

    h1 {
      display: inline-block;
      margin: 0;
      padding: $column-gutter / 2;
    }

    .counts {
      color: $small-font-color;
      font-size: $small-font-size;
      padding-top: $project-angle-section-padding / 2;
      text-transform: uppercase;

      span {
        font-weight: $font-weight-bold;
        padding-left: $column-gutter / 2;
      }
    }
  }

  section {
    @extend %grid-row;

    @include clearfix();

    background-color: $project-angle-background-color;
    border-top: $project-angle-border;
    padding: $project-angle-section-padding / 2 $project-angle-section-padding;

    &:last-child {
      border-bottom: 1px solid $project-angle-border-color;
    }

    h5 {
      padding-bottom: $project-angle-section-padding / 2;
      padding-left: $column-gutter / 2;
      padding-right: $column-gutter / 2;
    }
  }
}

%input-avatar {
  @include angle-avatar-input-grid-size;

  position: relative;

  img {
    border-radius: $angle-member-radius;
    height: $angle-member-width;
    overflow: hidden;
    padding: $angle-member-inner-padding;
    position: absolute;
    width: $angle-member-width;
    z-index: 1;
  }

  input {
    -moz-appearance: textfield;
    border: $angle-member-border;
    border-radius: $angle-member-radius;
    box-shadow: none;
    box-sizing: border-box;
    color: $project-angles-text-color;
    font-size: $h2-font-size;
    height: $angle-member-width;
    padding-bottom: 0;
    padding-left: $angle-member-width * 1.2 + $angle-member-inner-padding;
    padding-right: $super-number-arrow-size * 1.2;
    padding-top: 0;
    position: relative;
    width: 100%;

    &:focus {
      outline: none;
    }
  }

  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button {
    display: none;
  }
}

%angle-avatar-add-button {
  @include button-icon(plus);

  background-color: $angle-add-member-button-color;
  border-color: darken($angle-add-member-button-color, 5%);
  color: $white;

  &:before {
    line-height: $angle-add-member-button-size;
    width: $angle-add-member-button-size;
  }
}

.actions {
  button {
    &.previous {
      @include button-icon(angle-left);
    }

    &.next {
      @include button-icon(angle-right);
    }
  }
}
